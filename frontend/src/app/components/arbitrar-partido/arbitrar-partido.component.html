<div *ngIf="partido; else cargando" class="container mt-4">
  <div class="card">
    <div class="card-body">
      <h2 class="card-title text-center">{{ partido.local.nombre }} <span class="text-muted">vs</span> {{ partido.visitante.nombre }}</h2>
      <p class="text-center text-secondary">Fecha: {{ partido.fecha_prevista | date:'medium' }}</p>

      <div class="d-flex justify-content-center align-items-center my-3 gap-3">
        <h3>Parte actual: {{ parteActual > 0 ? parteActual : 'No iniciado' }}</h3>
        <h3 class="ms-4">Tiempo: {{ tiempoFormateado }}</h3>
      </div>

      <div class="d-flex justify-content-center gap-2 mb-3">
        <button class="btn btn-success" (click)="iniciarPartido()" [disabled]="parteActual > 0">Iniciar</button>
        <button class="btn btn-danger" (click)="detenerPartido()" [disabled]="parteActual === 0">Detener</button>
      </div>

      <div class="d-flex justify-content-center gap-2 mb-4">
        <span class="me-2">Velocidad:</span>
        <button class="btn btn-outline-primary" [class.active]="velocidad === 1" (click)="cambiarVelocidad(1)">x1</button>
        <button class="btn btn-outline-primary" [class.active]="velocidad === 20" (click)="cambiarVelocidad(20)">x20</button>
        <button class="btn btn-outline-primary" [class.active]="velocidad === 40" (click)="cambiarVelocidad(40)">x40</button>
        <button class="btn btn-outline-primary" [class.active]="velocidad === 80" (click)="cambiarVelocidad(80)">x80</button>
        <button class="btn btn-outline-primary" [class.active]="velocidad === 200" (click)="cambiarVelocidad(200)">x200</button>
      </div>

      <!-- NUEVO BLOQUE DE BOTONES -->
      <div class="mt-4">
        <h4 class="text-center mb-3">Eventos especiales</h4>
        <div class="d-flex flex-wrap justify-content-center gap-3 mb-4">
          <button *ngFor="let tipo of tipoEventosEspeciales" class="btn btn-warning tipo-evento-btn"
                  type="button" title="{{ tipo.nombre }}" (click)="onTipoEventoClick(tipo.nombre)">
            {{ tipo.nombre }}
          </button>
        </div>

        <h4 class="text-center mb-3">Eventos normales</h4>
        <div class="d-flex flex-wrap justify-content-center gap-3">
          <button *ngFor="let tipo of tipoEventosNormales" class="btn btn-outline-primary tipo-evento-btn"
                  type="button" title="{{ tipo.nombre }}" (click)="onTipoEventoClick(tipo.nombre)">
            {{ tipo.nombre }}
          </button>
        </div>
      </div>
      <!-- FIN NUEVO BLOQUE -->
    </div>
  </div>
</div>


<!-- Modal personalizado para once inicial -->
<div class="modal-custom" *ngIf="mostrarModalOnceInicial">
  <div class="modal-content-custom">
    <h2>Seleccionar Once Inicial</h2>
    <p>Seleccione exactamente 11 jugadores ({{ jugadoresSeleccionadosIds.size }}/11):</p>
    <div class="jugadores-lista">
      <div *ngFor="let jugador of jugadoresOnceInicial" class="jugador-checkbox">
        <input type="checkbox"
               [id]="'jugador-' + jugador.id_jugador"
               [checked]="jugadoresSeleccionadosIds.has(jugador.id_jugador)"
               (change)="toggleJugadorSeleccionado(jugador)"
               [disabled]="!jugadoresSeleccionadosIds.has(jugador.id_jugador) && jugadoresSeleccionadosIds.size >= 11">
        <label [for]="'jugador-' + jugador.id_jugador">
          {{ jugador.nombre }} ({{ jugador.dorsal }})
        </label>
      </div>
    </div>
    <div class="modal-buttons">
      <button (click)="confirmarOnceInicial()" [disabled]="jugadoresSeleccionadosIds.size !== 11">Confirmar</button>
      <button (click)="ocultarModalOnceInicial()">Cancelar</button>
    </div>
  </div>
</div>

<ng-template #cargando>
  <p class="text-center mt-3">Cargando partido...</p>
</ng-template>
